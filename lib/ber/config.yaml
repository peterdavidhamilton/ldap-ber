#
# tag_class, encoding_type, identified_type, syntax, request, response, result, oid
#
---
#
# Used to compile syntaxes
#
:tag_class:
  :universal:         0b00000000  # 0
  :application:       0b01000000  # 64
  :context_specific:  0b10000000  # 128
  :private:           0b11000000  # 192

:encoding_type:
  :primitive:         0b00000000  # 0
  :constructed:       0b00100000  # 32

:identified_type:
  :universal:
    :primitive:
      1:    :boolean
      2:    :integer
      4:    :string
      5:    :null
      6:    :oid
      10:   :integer
      13:   :string             # (relative OID)

    :constructed:
      16:   :array
      17:   :array

  :context_specific:
    :primitive:
      10:   :integer

#
# Abstract Syntax Notation One - ASN.1
#
:syntax:
  :application:
    :primitive:
      2:                        # UnbindRequest body # nil!
    :constructed:
      0:  :array                # BindRequest
      1:  :array                # BindResponse
      2:  :array                # UnbindRequest
      3:  :array                # SearchRequest
      4:  :array                # SearchData
      5:  :array                # SearchResult
      6:  :array                # ModifyRequest
      7:  :array                # ModifyResponse
      8:  :array                # AddRequest
      9:  :array                # AddResponse
      10: :array                # DelRequest
      11: :array                # DelResponse
      12: :array                # ModifyRdnRequest
      13: :array                # ModifyRdnResponse
      14: :array                # CompareRequest
      15: :array                # CompareResponse
      16: :array                # AbandonRequest
      19: :array                # SearchResultReferral
      24: :array                # Unsolicited Notification

  :universal:
    :constructed:
      107: :array               # ExtendedResponse (PasswdModifyResponseValue)

  :context_specific:
    :primitive:
      0: :string                # password
      1: :string                # Kerberos v4
      2: :string                # Kerberos v5
      3: :string                # SearchFilter-extensible
      4: :string                # SearchFilter-extensible
      7: :string                # serverSaslCreds
    :constructed:
      0: :array                 # RFC-2251 Control and Filter-AND
      1: :array                 # SearchFilter-OR
      2: :array                 # SearchFilter-NOT
      3: :array                 # Search referral
      4: :array                 # unknown use in Microsoft Outlook
      5: :array                 # SearchFilter-GE
      6: :array                 # SearchFilter-LE
      7: :array                 # serverSaslCreds
      9: :array                 # SearchFilter-extensible

#
# Internal request symbol to LDAP code mapping.
#
:request:
  :con_and:             0xa0   # constructed  0, "and"
  :con_or:              0xa1   # constructed  1, "or"
  :con_not:             0xa2   # constructed  2, "not"
  :equality_match:      0xa3   # constructed  3, "equalityMatch"
  :substring:           0xa4   # constructed  4, "substring"
  :op_gte:              0xa5   # constructed  5, "greaterOrEqual"
  :op_lte:              0xa6   # constructed  6, "lessOrEqual"
  :substr_initial:      0x80   # primitive    0, SubstringFilter "initial"
  :substr_any:          0x81   # primitive    0, SubstringFilter "any"
  :substr_final:        0x82   # primitive    0, SubstringFilter "final"
  :is_present:          0x87   # primitive    7, "present"
  :op_ext:              0xa9   # constructed  9, "extensible comparison"


#
# LDAP response code to internal symbol mapping. (Protocol Data Unit)
#
:response:
  0:  :bind_request
  1:  :bind_result
  2:  :unbind_request
  3:  :search_request
  4:  :search_returned_data
  5:  :search_result
  6:  :modify_request
  7:  :modify_response
  8:  :add_request
  9:  :add_response
  10: :delete_request
  11: :delete_response
  12: :modify_rdn_request
  13: :modify_rdn_response
  14: :compare_request
  15: :compare_response
  16: :abandon_request
  19: :search_result_referral
  23: :extended_request
  24: :extended_response
  25: :intermediate_response



# LDAP Operation return codes.
#
# code_int:
#   - :internal_symbol
#   - Log message
#   - Descriptive explanation
#   - <directory internal>:<HEX>
#
:result:
  0:
    - :success
    - LDAP Success
    - Indicates the requested client operation completed successfully.
    - LDAP_SUCCESS:0x00
  1:
    - :operations_error
    - LDAP Operations Error
    - >
      Indicates an internal error.
      The server is unable to respond with a more specific error and is also unable to properly respond to a request.
      It does not indicate that the client has sent an erroneous message.
    - LDAP_OPERATIONS_ERROR:0x01
  2:
    - :protocol_error
    - LDAP Protocol Error
    - Indicates that the server has received an invalid or malformed request from the client.
    - LDAP_PROTOCOL_ERROR:0x02
  3:
    - :time_limit_exceeded
    - LDAP Time Limit Exceeded
    - >
      Indicates the operation's time limit specified by either the client or the server has been exceeded.
      On search operations, incomplete results are returned.
    - LDAP_TIMELIMIT_EXCEEDED:0x03
  4:
    - :size_limit_exceeded
    - LDAP Size Limit Exceeded
    - >
      Indicates in a search operation, the size limit specified by the client or the server has been exceeded.
      Incomplete results are returned.
    - LDAP_SIZELIMIT_EXCEEDED:0x04
  5:
    - :compare_false
    - LDAP False Comparison
    - >
      Does not indicate an error condition.
      Indicates that the results of a compare operation are false.
    - LDAP_COMPARE_FALSE:0x05
  6:
    - :compare_true
    - LDAP True Comparison
    - >
      Does not indicate an error condition.
      Indicates that the results of a compare operation are true.
    - LDAP_COMPARE_TRUE:0x06
  7:
    - :auth_method_not_supported
    - LDAP Authentication Method Not Supported
    - Indicates during a bind operation the client requested an authentication method not supported by the LDAP server.
    - LDAP_AUTH_METHOD_NOT_SUPPORTED:0x07
  8:
    - :stronger_auth_required
    - LDAP Stronger Authentication Needed
    - >
      Indicates one of the following:
      In bind requests, the LDAP server accepts only strong authentication.
      In a client request, the client requested an operation such as delete that requires strong authentication.
      In an unsolicited notice of disconnection, the LDAP server discovers the security protecting the communication between the client and server has unexpectedly failed or been compromised.
    - LDAP_STRONG_AUTH_REQUIRED:0x08
  9:
    -
    - LDAP Reserved.
    -
    - Reserved:0x09
  10:
    - :referral
    - LDAP Referral
    - >
      Does not indicate an error condition.
      In LDAPv3, indicates that the server does not hold the target entry of the request, but that the servers in the referral field may.
    - LDAP_REFERRAL:0x0A
  11:
    - :admin_limit_exceeded
    - LDAP Admin Limit Exceeded
    - Indicates an LDAP server limit set by an administrative authority has been exceeded.
    - LDAP_ADMINLIMIT_EXCEEDED:0x0B
  12:
    - :unavailable_critical_extension
    - LDAP Unavailable Critical Extension
    - >
      Indicates the LDAP server was unable to satisfy a request because one or more critical extensions were not available.
      Either the server does not support the control or the control is not appropriate for the operation type.
    - LDAP_UNAVAILABLE_CRITICAL_EXTENSION:0x0C
  13:
    - :confidentiality_required
    - LDAP Confidentiality Required
    - Indicates the session is not protected by a protocol such as Transport Layer Security (TLS), which provides session confidentiality.
    - LDAP_CONFIDENTIALITY_REQUIRED:0x0D
  14:
    - :sasl_bind_in_progress
    - LDAP saslBindInProgress
    - >
      Does not indicate an error condition, but indicates the server is ready for the next step in the process.
      The client must send the server the same SASL mechanism to continue the process.
    - LDAP_SASL_BIND_IN_PROGRESS:0x0E
  15:
    -
    - LDAP Not used.
    -
    - NotUsed:0x0F
  16:
    - :no_such_attribute
    - LDAP No Such Attribute
    - Indicates the attribute specified in the modify or compare operation does not exist in the entry.
    - LDAP_NO_SUCH_ATTRIBUTE:0x10
  17:
    - :undefined_attribute_type
    - LDAP Undefined Attribute Type
    - Indicates the attribute specified in the modify or add operation does not exist in the LDAP server's schema.
    - LDAP_UNDEFINED_TYPE:0x11
  18:
    - :inappropriate_matching
    - LDAP Inappropriate Matching
    - Indicates the matching rule specified in the search filter does not match a rule defined for the attribute's syntax.
    - LDAP_INAPPROPRIATE_MATCHING:0x12
  19:
    - :constraint_violation
    - LDAP Constraint Violation
    - >
      Indicates the attribute value specified in a modify, add, or modify DN operation violates constraints placed on the attribute.
      The constraint can be one of size or content (string only, no binary).
    - LDAP_CONSTRAINT_VIOLATION:0x13
  20:
    - :attribute_or_value_exists
    - LDAP Attribute or Value Exists
    - Indicates the attribute value specified in a modify or add operation already exists as a value for that attribute.
    - LDAP_TYPE_OR_VALUE_EXISTS:0x14
  21:
    - :invalid_attribute_syntax
    - LDAP Invalid Attribute Syntax
    - Indicates the attribute value specified in an add, compare, or modify operation is an unrecognized or invalid syntax for the attribute.
    - LDAP_INVALID_SYNTAX:0x15
  #
  # 22..31 - Not used.
  #
  32:
    - :no_such_object
    - LDAP No Such Object
    - >
      Indicates the target object cannot be found.
      This code is not returned on following operations:
      Search operations that find the search base but cannot find any entries that match the search filter.
      Bind operations.
    - LDAP_NO_SUCH_OBJECT:0x20
  33:
    - :alias_problem
    - LDAP Alias Problem
    - Indicates an error occurred when an alias was dereferenced.
    - LDAP_ALIAS_PROBLEM:0x21
  34:
    - :invalid_dn_syntax
    - LDAP Invalid DN Syntax
    - >
      Indicates the syntax of the DN is incorrect.
      If the DN syntax is correct, but the LDAP server's structure rules do not permit the operation, the server returns LDAP_UNWILLING_TO_PERFORM.
    - LDAP_INVALID_DN_SYNTAX:0x22
  35:
    - :ldap_is_leaf
    - LDAP Failed On Leaf
    - >
      Indicates the specified operation cannot be performed on a leaf entry.
      This code is not currently in the LDAP specifications, but is reserved for this constant.
    - LDAP_IS_LEAF:0x23
  36:
    - :alias_dereferencing_problem
    - LDAP Alias Dereferencing Problem
    - Indicates during a search operation, either the client does not have access rights to read the aliased object's name or dereferencing is not allowed.
    - LDAP_ALIAS_DEREF_PROBLEM:0x24
  #
  # 37..47 - Not used.
  #
  48:
    - :inappropriate_authentication
    - LDAP Inappropriate Authentication
    - >
      Indicates during a bind operation, the client is attempting to use an authentication method that the client cannot use correctly.
      For example, either of the following cause this error:
      The client returns simple credentials when strong credentials are required.
      The client returns a DN and a password for a simple bind when the entry does not have a password defined.
    - LDAP_INAPPROPRIATE_AUTH:0x30
  49:
    - :invalid_credentials
    - LDAP Invalid Credentials
    - >
      Indicates during a bind operation one of the following occurred:
      The client passed either an incorrect DN or password.
      The password is incorrect because it has expired, intruder detection has locked the account, or some other similar reason.
    - LDAP_INVALID_CREDENTIALS:0x31
  50:
    - :insufficient_access_rights
    - LDAP Insufficient Access Rights
    - Indicates the caller does not have sufficient rights to perform the requested operation.
    - LDAP_INSUFFICIENT_ACCESS:0x32
  51:
    - :busy
    - LDAP Busy
    - Indicates the LDAP server is too busy to process the client request at this time but if the client waits and resubmits the request, the server may be able to process it then.
    - LDAP_BUSY:0x33
  52:
    - :unavailable
    - LDAP Unavailable
    - Indicates the LDAP server cannot process the client's bind request, usually because it is shutting down.
    - LDAP_UNAVAILABLE:0x34
  53:
    - :unwilling_to_perform
    - LDAP Unwilling To Perform
    - >
      Indicates the LDAP server cannot process the request because of server-defined restrictions.
      This error is returned for the following reasons:
      The add entry request violates the server's structure rules.
      The modify attribute request specifies attributes that users cannot modify.
      Password restrictions prevent the action.
      Connection restrictions prevent the action.
    - LDAP_UNWILLING_TO_PERFORM:0x35
  54:
    - :loop_detected
    - LDAP Referral Loop Detected
    - Indicates the client discovered an alias or referral loop, and is thus unable to complete this request.
    - LDAP_LOOP_DETECT:0x36
  #
  # 55..63 - Not used.
  #
  64:
    - :naming_violation
    - LDAP Naming Violation
    - >
      Indicates the add or modify DN operation violates the schema's structure rules. For example,
      The request places the entry subordinate to an alias.
      The request places the entry subordinate to a container that is forbidden by the containment rules.
      The RDN for the entry uses a forbidden attribute type.
      LDAP_NAMING_VIOLATION:0x40
  65:
    - :object_class_violation
    - LDAP Object Class Violation
    - >
      Indicates the add, modify, or modify DN operation violates the object class rules for the entry.
      For example, the following types of request return this error:
      The add or modify operation tries to add an entry without a value for a required attribute.
      The add or modify operation tries to add an entry with a value for an attribute which the class definition does not contain.
      The modify operation tries to remove a required attribute without removing the auxiliary class that defines the attribute as required.
    - LDAP_OBJECT_CLASS_VIOLATION:0x41
  66:
    - :not_allowed_on_non_leaf
    - LDAP Not Allowed On Non-Leaf
    - >
      Indicates the requested operation is permitted only on leaf entries.
      For example, the following types of requests return this error:
      The client requests a delete operation on a parent entry.
      The client request a modify DN operation on a parent entry.
    - LDAP_NOT_ALLOWED_ON_NONLEAF:0x42
  67:
    - :not_allowed_on_rdn
    - LDAP Not Allowed On RDN
    - Indicates the modify operation attempted to remove an attribute value that forms the entry's relative distinguished name.
    - LDAP_NOT_ALLOWED_ON_RDN:0x43
  68:
    - :entry_already_exists
    - LDAP Entry Already Exists
    - Indicates the add operation attempted to add an entry that already exists, or that the modify operation attempted to rename an entry to the name of an entry that already exists.
    - LDAP_ALREADY_EXISTS:0x44
  69:
    - :object_class_mods_prohibited
    - LDAP ObjectClass Modifications Prohibited
    - Indicates the modify operation attempted to modify the structure rules of an object class.
    - LDAP_NO_OBJECT_CLASS_MODS:0x45
  70:
    - :reserved_for_cldap
    - LDAP Reserved for CLDAP
    -
    - LDAP_RESULTS_TOO_LARGE:0x46
  71:
    - :affects_multiple_dsas
    - LDAP Affects Multiple DSAs
    - Indicates the modify DN operation moves the entry from one LDAP server to another and thus requires more than one LDAP server.
    - LDAP_AFFECTS_MULTIPLE_DSAS:0x47
  #
  # 72..79 - Not used.
  #
  80:
    - :other
    - LDAP Other
    - >
      Indicates an unknown error condition.
      This is the default value for NDS error codes which do not map to other LDAP error codes.
    - LDAP_OTHER:0x50
  81:
    - :server_down
    - LDAP Server Down
    - Indicates the LDAP client cannot establish a connection with, or lost the connection to, the LDAP server.
    - LDAP_SERVER_DOWN:0x51
  82:
    - :local_error
    - LDAP Local Client Error
    - Indicates an error occurred in the LDAP client.
    - LDAP_LOCAL_ERROR:0x52
  83:
    - :encoding_error
    - LDAP Encoding Error
    - Indicates the LDAP client encountered an error when encoding the LDAP request to be sent to the server.
    - LDAP_ENCODING_ERROR:0x53
  84:
    - :decoding_error
    - LDAP Decoding Error
    - Indicates the LDAP client encountered an error when decoding the LDAP response received from the server.
    - LDAP_DECODING_ERROR:0x54
  85:
    - :timeout
    - LDAP Timeout
    - >
      Indicates the LDAP client timed out while waiting for a response from the server.
      The specified timeout period has been exceeded and the server has not responded.
    - LDAP_TIMEOUT:0x55
  86:
    - :auth_method_unknown
    - LDAP Unknown Authentication Method
    - Indicates an unknown authentication method was specified.
    - LDAP_AUTH_UNKNOWN:0x56
  87:
    - :filter_error
    - LDAP Filter Error
    - Indicates an error occurred when specifying the search filter.
    - LDAP_FILTER_ERROR:0x57
  88:
    - :user_cancelled
    - LDAP User Cancelled
    - Indicates the user cancelled the LDAP operation
    - LDAP_USER_CANCELLED:0x58
  89:
    - :param_error
    - LDAP Invalid Parameter
    - Indicates that an invalid parameter was specified.
    - LDAP_PARAM_ERROR:0x59
  90:
    - :no_memory
    - LDAP No Memory
    - >
      Indicates that no memory is available.
      For example, when creating an LDAP request or an LDAP control.
    - LDAP_NO_MEMORY:0x5a
  91:
    - :connect_error
    - LDAP Connection Error
    - Indicates the LDAP client cannot establish a connection, or has lost the connection, with the LDAP server.
    - LDAP_CONNECT_ERROR:0x5b
  92:
    - :not_supported
    - LDAP Not Supported
    - >
      Indicates that the LDAP client is attempting to use functionality that is not supported.
      For example, the client identifies itself as an LDAPv2 client, and attempt to use functionality only available in LDAPv3.
    - LDAP_NOT_SUPPORTED:0x5c
  93:
    - :control_not_found
    - LDAP Control Not Found
    - >
      Indicates a requested LDAP control was not found.
      This result code is set when the client parsing a server response for controls and not finding the requested controls
    - LDAP_CONTROL_NOT_FOUND:0x5d
  94:
    - :no_results_returned
    - LDAP No Results returned
    - Indicates no results were returned from the server.
    - LDAP_NO_RESULTS_RETURNED:0x5e
  95:
    - :more_results
    - LDAP More Results To Return
    - >
      Indicates there are more results in the chain of results.
      This result code is returned when additional result codes are available from the LDAP server.
    - LDAP_MORE_RESULTS_TO_RETURN:0x5f
  96:
    - :client_loop
    - LDAP Client Loop
    - Indicates the LDAP client detected a loop, for example, when following referrals.
    - LDAP_CLIENT_LOOP:0x60
  97:
    - :referral_limit
    - LDAP Referral Limit Exceeded
    - >
      Indicates that the referral hop limit was exceeded.
      This result code is if the client is referred to other servers more times than allowed by the referral hop limit.
    - LDAP_REFERRAL_LIMIT_EXCEEDED:0x61




#
# OID to Ruby object or Dry::Type mapping.
#
# @see https://tools.ietf.org/html/rfc2252.html
#
:oid:
  1.2.840.113556.1.2.19:           Time
  1.2.840.113556.1.4.49:           Time
  1.2.840.113556.1.4.52:           Time
  1.2.840.113556.1.4.53:           Time
  1.2.840.113556.1.4.96:           Time
  1.2.840.113556.1.2.120:          Time
  1.2.840.113556.1.4.906:          Int
  1.2.840.113556.1.4.907:          String
  1.2.840.113556.1.4.1221:         String
  1.2.840.113556.1.4.1362:         String
  1.2.840.113556.1.4.1221:         String
  1.2.840.113556.1.4.1696:         Time
  1.3.6.1.1.16.1:                  String     # UUID
  1.3.6.1.4.1.1466.115.121.1.1:    String     # ACI Item
  1.3.6.1.4.1.1466.115.121.1.2:    String     # Access Point
  1.3.6.1.4.1.1466.115.121.1.3:    String     # Attribute Type Description
  1.3.6.1.4.1.1466.115.121.1.4:    Binary     # Audio
  1.3.6.1.4.1.1466.115.121.1.5:    Binary     # Binary
  1.3.6.1.4.1.1466.115.121.1.6:    String     # Bit String
  1.3.6.1.4.1.1466.115.121.1.7:    Bool       # Boolean
  1.3.6.1.4.1.1466.115.121.1.8:    String     # Certificate
  1.3.6.1.4.1.1466.115.121.1.9:    String     # Certificate List
  1.3.6.1.4.1.1466.115.121.1.10:   String     # Certificate Pair
  1.3.6.1.4.1.1466.115.121.1.11:   String     # Country String - IA5 ISO-646 (ASCII). Limited to exactly two characters describing the ISO 3166 country code.
  1.3.6.1.4.1.1466.115.121.1.12:   String     # DN
  1.3.6.1.4.1.1466.115.121.1.13:   String     # Data Quality Syntax
  1.3.6.1.4.1.1466.115.121.1.14:   String     # Delivery Method
  1.3.6.1.4.1.1466.115.121.1.15:   String     # Directory String
  1.3.6.1.4.1.1466.115.121.1.19:   String     # DSA Quality Syntax
  1.3.6.1.4.1.1466.115.121.1.20:   String     # DSE Type
  1.3.6.1.4.1.1466.115.121.1.21:   String     # Enhanced Guide
  1.3.6.1.4.1.1466.115.121.1.22:   String     # Facsimile Telephone Number
  1.3.6.1.4.1.1466.115.121.1.23:   String     # Fax
  1.3.6.1.4.1.1466.115.121.1.24:   Time       # Generalized Time
  1.3.6.1.4.1.1466.115.121.1.25:   String     # Guide
  1.3.6.1.4.1.1466.115.121.1.26:   String     # IA5String - IA5 ISO-646 (ASCII).
  1.3.6.1.4.1.1466.115.121.1.27:   Int        # INTEGER
  1.3.6.1.4.1.1466.115.121.1.28:   Binary     # JPEG - RFC2798: Joint Photographic Experts Group (JPEG) image syntax from inetOrgPerson object class schema.
  1.3.6.1.4.1.1466.115.121.1.32:   String     # Mail Preference
  1.3.6.1.4.1.1466.115.121.1.34:   String     # Name And Optional UID
  1.3.6.1.4.1.1466.115.121.1.35:   String     # Name Form Description
  1.3.6.1.4.1.1466.115.121.1.36:   Int        # Numeric String - IA5 ISO-646 (ASCII).
  1.3.6.1.4.1.1466.115.121.1.37:   String     # Object Class Description
  1.3.6.1.4.1.1466.115.121.1.40:   Octet      # Octet String - Treated as transparent 8-bit bytes.
  1.3.6.1.4.1.1466.115.121.1.38:   String     # OID
  1.3.6.1.4.1.1466.115.121.1.39:   String     # Other Mailbox
  1.3.6.1.4.1.1466.115.121.1.40:   Octet      # Octet String - Treated as transparent 8-bit bytes.
  1.3.6.1.4.1.1466.115.121.1.41:   String     # Postal Address - UTF-8 ISO-10646 (Unicode). Split by dollar sign "$".
  1.3.6.1.4.1.1466.115.121.1.42:   String     # Protocol Information
  1.3.6.1.4.1.1466.115.121.1.43:   String     # Presentation Address
  1.3.6.1.4.1.1466.115.121.1.44:   String     # Printable String
  1.3.6.1.4.1.1466.115.121.1.50:   String     # Telephone Number
  1.3.6.1.4.1.1466.115.121.1.51:   String     # Teletex Terminal Identifier
  1.3.6.1.4.1.1466.115.121.1.52:   String     # Telex Number
  1.3.6.1.4.1.1466.115.121.1.53:   Time       # UTC Time
  1.3.6.1.4.1.1466.115.121.1.54:   String     # LDAP Syntax Description
  1.3.6.1.4.1.1466.115.121.1.56:   String     # LDAP Schema Definition
  1.3.6.1.4.1.1466.115.121.1.57:   String     # LDAP Schema Description
